{
    "componentChunkName": "component---src-templates-post-js",
    "path": "/post/Node-RESTful-API-1",
    "result": {"data":{"markdownRemark":{"frontmatter":{"title":"Node-RESTful API (1)","date":"March 18th, 2019"},"html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 512px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAEFUlEQVQ4y3WU30scVxTHJwnpa/+AQIp9E8SHfVC0rUQ0ULGrddsKISYN0irUBCOVmIc0WkVLILZQg6UhRBKKpQnUSFNNf5Jt2qht1pjaRo1Zt66jrmbXmXN2dtbdnb3fcsdZOy8dONy7e+98zvfOPeerEJHCzDL2OKOMA8x8lojuMnOEmTNElGbmFWYeJ6L3mPl5uZeI9khGLhQHuNdZlPMzRKQzM9xBRHa45iozH3OJsMG7EyLaz8yjuReYWSqymFkQkZAjM2eJKGMYRsaVYCAnxq1QxqizSYKyjrIcyIbmwOvr6zBN04rH4xkH+rHD2KsYhqFomnbGWUg5L2EXQP8dV9M0ZLNZ0d/fL9rb25FIJOReS65tbW3VSaiyvLx8wDRNXdd16LpuK9NJt6FG3ICma7vAaDQK+fT19aGgoEDEYjHkgKZpPh4aGtqvADirqiqSyWR6e3vbhqXMtA1af7aGdDJjX4RhGEin04jH4+jp6UFJSQlisZiwLEuuWeqqKnP5lI6ODn9xcTFaW1ut+YV5kTAS4lFoGhfGz+H9r5rwbeCWTIKNjQ0MDAygtLQURUVFqKiokIrF7OysaGxszJS9Uobz5z+4qng8ns22tjZ4PB5x9EiDCEWCaL3xNt69/iZaho+i7tMK/DT3Az4fvIyDLxxEc3MzysvLUVlZiXA4jKqqKlHyUonVcKIBeXl5U4rX681KrSdPnRR1NT4xp/6FY9dfx6nh42i/+Q7e+uxV3AzcwMWPLqKouAjys/T29toql0JLOFR2SHR82CHuLd3FlctX4kpTU5MlgV1dXaLmtRrxTySEmkvVqL1UiZbhIzhxtRbTy79j+NqXyHsxD9XV1SgsLITP50MkEkF9fb3Iz88X3d3dUvGmEolEVPnBo9Fo1v+LX2gxDYvqInpGO3Fh7BwCwUn8GZrBovoEY7fH4PV6ZXKsrKzIm5UQ0dnZadXW1mJkZMQv6/COvHZZpKlUShCT2E5sI2WmEFoPYerJJB6H/8Yfi1N4tDKD6FbUvm0zacoyE8lkUqRSKbvAs9nsoKLreotTyBlZi7KYZckkDBP353+zYfce+/Hz7I/4fuYOgmtBGLxTn7JrJFTXddmisowOK45rrDqdYu0UsS4S8YStSh71i1+vYfTB1xh/eBtLa0HINaeT4DiR/D2haZqS6+Pjzp8ZOyvpMA1TPAxOi+9mxhB4+gDTwQC+CdxCeCMsk+VgWZeZvGy3nvQzBzrgUmnlzOHp6qKYXLgvJhcmhLqpCiNu5Ewi44Kddhj7FJcPyvjE5X8SmjEN04ppMRuSMBKWcwrLZV+nc0ZrK3SbozP3EdHc/5iqez4hj+n44K7bK277ln7mjM8R0RtENMTME7TzPGNmPxENEtFhl4B9LtdW/gV3cBpX/1VxkgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nodejs\"\n        title=\"nodejs\"\n        src=\"/static/55e83371dbf50a5f027b1fe31a054ad3/01e7c/nodejs.png\"\n        srcset=\"/static/55e83371dbf50a5f027b1fe31a054ad3/4dcb9/nodejs.png 188w,\n/static/55e83371dbf50a5f027b1fe31a054ad3/5ff7e/nodejs.png 375w,\n/static/55e83371dbf50a5f027b1fe31a054ad3/01e7c/nodejs.png 512w\"\n        sizes=\"(max-width: 512px) 100vw, 512px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3>Mongoose 사용하기</h3>\n<hr>\n<p>Mongoose란 ODM(Object Document Mapper)으로</p>\n<p>mySQL을 사용할 때 Sequelize란 ORM(Object Relational Mapper)와 유사한 기능을 한다.</p>\n<p><strong>mongoose.js</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> mongoose <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mongoose'</span><span class=\"token punctuation\">)</span>\n\nmongoose<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mongodb://127.0.0.1:27017/task-manager'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">auth</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string-property property\">\"authSource\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"admin\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">user</span><span class=\"token operator\">:</span> <span class=\"token string\">'csheum'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">password</span><span class=\"token operator\">:</span> <span class=\"token string\">'password'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">useNewUrlParser</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> User <span class=\"token operator\">=</span> mongoose<span class=\"token punctuation\">.</span><span class=\"token function\">model</span><span class=\"token punctuation\">(</span><span class=\"token string\">'User'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> String\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> \n  <span class=\"token literal-property property\">age</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> Number\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> me <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'nailerHeum'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">age</span><span class=\"token operator\">:</span> <span class=\"token number\">25</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\nme<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>me<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=></span><span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>마찬가지로 권한 문제가 발생했기 때문에 관련 정보를 넣어줘야 한다.</p>\n<p>해당하는 attribute에서 지정한 dataType을 넣어주지 않으면 validation error가 발생한다.</p>\n<p>Task 하나를 새로 만들어봤다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> newTask <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Task</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">description</span><span class=\"token operator\">:</span> <span class=\"token string\">'코드스쿼드를 들어간다.'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">completed</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\nnewTask<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>newTask<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>newTask<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// 그 결과</span>\n<span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">_id</span><span class=\"token operator\">:</span> 5c80c374bb3cdc814e9f0ee9<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">description</span><span class=\"token operator\">:</span> <span class=\"token string\">'코드스쿼드를 들어간다.'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">completed</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">__v</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<p>mongoose로 model의 이름을 설정할 때는 첫글자는 대문자, 단수형으로 생성한다.</p>\n<p>mongoose를 통해 생성하면 자동으로 mongoDB에서는 모두 소문자로 바뀌며 복수형으로 만들게 된다.</p>\n<p>예를 들어 User라고 생성하면 users로 바뀌는 것이다.</p>\n<h3>Data Validation and Sanitization</h3>\n<hr>\n<p><strong>Data sanitization</strong> is the process of deliberately, permanently, and irreversibly removing or destroying the <strong>data</strong> stored on a memory device. A device that has been <strong>sanitized</strong> has no usable residual <strong>data</strong> and even advanced forensic tools should not ever be able recover erased <strong>data</strong>.</p>\n<p>Data Validation을 통해 특정 attribute가 공란일 경우 에러를 돌려주게 만들 수 있다.</p>\n<p>mongoose docs에서 Built-in Validator들을 확인할 수 있다.</p>\n<p>해당 링크 : <a href=\"https://mongoosejs.com/docs/validation.html#built-in-validators\">https://mongoosejs.com/docs/validation.html#built-in-validators</a></p>\n<p>validator.js를 활용해서 편리하게 validation을 적용할 수 있다.</p>\n<p>validate() method를 이용하여  커스터마이징된 validation check 가능</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token literal-property property\">email</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> String<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">required</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">trim</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">lovwercase</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">validate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>validator<span class=\"token punctuation\">.</span><span class=\"token function\">isEmail</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Invalid Email'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.234042553191488%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAcUlEQVQI133FQQ6CMBBAUU4B0s5UCymlCUIlApooa+9/oW/CwqWLl1eEtmWab8Qt060P+teHdt6RuKBp+5G0HjQt2P7JeO/Y3yVTtrimoQsB7z3FMFwZc0KjR8IF9RbnDM6e/qgwtVBWZ0ztUFVE5PgLZeg40dTXJTsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20190313155525479\"\n        title=\"image-20190313155525479\"\n        src=\"/static/dadb95c262563d0d303aa0b8efbde85b/1d69c/image-20190313155525479.png\"\n        srcset=\"/static/dadb95c262563d0d303aa0b8efbde85b/4dcb9/image-20190313155525479.png 188w,\n/static/dadb95c262563d0d303aa0b8efbde85b/5ff7e/image-20190313155525479.png 375w,\n/static/dadb95c262563d0d303aa0b8efbde85b/1d69c/image-20190313155525479.png 750w,\n/static/dadb95c262563d0d303aa0b8efbde85b/78797/image-20190313155525479.png 1125w,\n/static/dadb95c262563d0d303aa0b8efbde85b/aa440/image-20190313155525479.png 1500w,\n/static/dadb95c262563d0d303aa0b8efbde85b/6b26f/image-20190313155525479.png 1658w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token literal-property property\">password</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> String<span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">required</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">trim</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">validate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">.</span>length <span class=\"token operator\">&lt;</span> <span class=\"token number\">7</span> <span class=\"token operator\">||</span> value<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span><span class=\"token string\">'password'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Invalid Password'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>trim : true  옵션은 string의 불필요한 앞뒤 공백을 제거해준다.</p>\n<h3>REST API</h3>\n<hr>\n<p>REST란</p>\n<blockquote>\n<p>Representational State Transfer</p>\n</blockquote>\n<p>API란</p>\n<blockquote>\n<p>Application Programming Interface</p>\n</blockquote>\n<p>HTTP method에서 가장 많이 썼던 4가지</p>\n<blockquote>\n<p>POST, GET, PATCH, DELETE</p>\n</blockquote>\n<p>HTTP Request와 Response에 대한 간단한 예시이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.340425531914896%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAACC0lEQVQoz12S70tTURzG90eVqXd3u/d2daNtboSZzB9RE8qshIKg0lJzTRNfmOireiVlIQZBIs3c1CiGGUpKOsW53f3u2t/wiXu2pHrx4XnOgfNwznm+NlnzIas+7JpXqGJvRZXaUKWgQJGCaPY2NLlNePU/ZMV/ctbKsolAzYdd9QqdePCOufFNXo0mmB1bZ/bpOnMTG8xPblTWVV6PfeXlaIKAv4s6pxuH1vR3oFcEOnU/H5aiJPd/8H17S2i+YJAvZIXmhK9SzFIo5ei43E2N5MKhV28oqR7sjgCS4kFpCLC29pl8Nkc6lcY4ypAzcmQzWYr5IuVi+R/Mssml0A1q7I1Ikp96hweb1xXixb0EHYH7nHE2cPtuHwPDER4OPRH0D4bpHwrz6HGEgfBIheERBsMjYs/lu4CmXmTh+Q53ro5jczV0EL42T7PnFvWqm5A3wk3/NNebJk/obZ6it2WKbu9EBZ/FM6G63oqinWd68D1d7X3Wk89xWtapU9woeoCFtyvsfkuz9SVJctPgcLtAaqeAkTTJ7P4UpHfLGHsmqZ0i7Z091MiNnKrXqXW4KqU4zjaJUiyNr65gZI/YP9jjMLVPKnVAqZTHNEscH5cxBSWOf1V855UeUYr1/6IUMUPVsbECZ2besPxxhcXFJaLRGLHYGvH4J2LLq8L/IV7VlmCIWtktzlqBvwEBrs+iGc+/VwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20190318172531536\"\n        title=\"image-20190318172531536\"\n        src=\"/static/30f552ab46542535bab462e4c7998cfd/1d69c/image-20190318172531536.png\"\n        srcset=\"/static/30f552ab46542535bab462e4c7998cfd/4dcb9/image-20190318172531536.png 188w,\n/static/30f552ab46542535bab462e4c7998cfd/5ff7e/image-20190318172531536.png 375w,\n/static/30f552ab46542535bab462e4c7998cfd/1d69c/image-20190318172531536.png 750w,\n/static/30f552ab46542535bab462e4c7998cfd/78797/image-20190318172531536.png 1125w,\n/static/30f552ab46542535bab462e4c7998cfd/aa440/image-20190318172531536.png 1500w,\n/static/30f552ab46542535bab462e4c7998cfd/f4fb1/image-20190318172531536.png 1766w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3>Resource Creation Endpoint</h3>\n<hr>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'express'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> port <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">PORT</span> <span class=\"token operator\">||</span> <span class=\"token number\">3000</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/users'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">'testing!'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>port<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Server is up on port '</span> <span class=\"token operator\">+</span> port<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.340425531914896%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABnElEQVQoz22Qa44SQRSFe2M2hkBMGBh+iLvQ3+7HvbgDEwMIw0uY7qa7+lGPfn+mamTCGCv5ck+qbt17crxvnz/x/csHvn4cMX6YMZs+MJ1OmT8+MhqN8f0Bg8F7fN93+p3vMxwOmc/nTCYT1zsej1ksFsxmM7zVes2vzYbdbsduv2d3OLA/HHjaHzhul+yXP3ha/uS0XXParDhtVxyPJ87nM5fLxWH1Da/ve+qqou06aBtMJijikNYodJGSiit5niOLgizLyJIrUkqMMZRl6bhpW71S5lRGU1U1pZKUucBkiRsaBiHXa4wQgjAMCYKA5yAgSRJ3F8fxq75VT2vtHNjpPbzS9T0midBxSN00NE1D17au3mP/2RlWt22LV9e1u7AP98dF0bZoY+i67r/YnqqqUEo5be88qaSzal3a4bbBYjPJ4xCjJKo0bqE0Gl2+OKrqyvX/i5fJgjB6yceGbgMvisJVEQVcowiRpm5pludOp2mKEjGtjeGvs67rHZ7drKRyDuzD/UmE4Pcl5DlKyXXzhkLXqLJDVf0b/gCZh430jxUd7gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20190318202503493\"\n        title=\"image-20190318202503493\"\n        src=\"/static/0cc182c4c26255e52180761348fa8e3a/1d69c/image-20190318202503493.png\"\n        srcset=\"/static/0cc182c4c26255e52180761348fa8e3a/4dcb9/image-20190318202503493.png 188w,\n/static/0cc182c4c26255e52180761348fa8e3a/5ff7e/image-20190318202503493.png 375w,\n/static/0cc182c4c26255e52180761348fa8e3a/1d69c/image-20190318202503493.png 750w,\n/static/0cc182c4c26255e52180761348fa8e3a/78797/image-20190318202503493.png 1125w,\n/static/0cc182c4c26255e52180761348fa8e3a/aa440/image-20190318202503493.png 1500w,\n/static/0cc182c4c26255e52180761348fa8e3a/aaf7f/image-20190318202503493.png 1668w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>postman을 통해 간단하게 post method를 test해봤다.</p>\n<p>목적은 유저 생성이기 때문에 Body에 JSON을 넣는다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.595744680851062%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA0UlEQVQY04WOXUvEQAxF+///nk+irA+udLtsO+18TyeTI9MqiD4YOOQmuVwyhBCIMZJSwjlHn3POeOewMZCiZx7fWcz98HjvD7r+Zt93SqcUhh52GPIZmFI4TNZarHP41bBNH8T5RthWUsrHreSEBktzhuZXWtioe2HoYf2rPWZKKgTfqFUAQVWQ1hAFUUVEaH0WOXWnVpp80doZ2FDMZWJ+HZmuwtuz8vKkXC/gVthLA5Tf9XcDw22cWLaCdRUzJ1ysPAzc7spjUXxWfPnR/+ET12GEthCyBAEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20190318202850164\"\n        title=\"image-20190318202850164\"\n        src=\"/static/3049480c34b4c1bf973ee25a15bc5a3a/1d69c/image-20190318202850164.png\"\n        srcset=\"/static/3049480c34b4c1bf973ee25a15bc5a3a/4dcb9/image-20190318202850164.png 188w,\n/static/3049480c34b4c1bf973ee25a15bc5a3a/5ff7e/image-20190318202850164.png 375w,\n/static/3049480c34b4c1bf973ee25a15bc5a3a/1d69c/image-20190318202850164.png 750w,\n/static/3049480c34b4c1bf973ee25a15bc5a3a/78797/image-20190318202850164.png 1125w,\n/static/3049480c34b4c1bf973ee25a15bc5a3a/bc3ae/image-20190318202850164.png 1268w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>이러한 내용을 postman을 통해 넘겨주기로 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">app<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/users'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">'testing!'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">//result</span>\nServer is up on port <span class=\"token number\">3000</span>\n<span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'choi'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">email</span><span class=\"token operator\">:</span> <span class=\"token string\">'kingman330@gmail.com'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">password</span><span class=\"token operator\">:</span> <span class=\"token string\">'seongheum123'</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<p>req.body를 통해 넘어온다는 사실을 확인할 수 있다.</p>\n<p>models 폴더에 user.js라는 파일을 생성하고 mongoose를 통해 작성한 user model을 따로 담아두고 export시켜 유지보수가 편하도록 한다.</p>\n<p>POST /users에 대한 처리를 아래와 같이 추가해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">app<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/users'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> user <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span>\n\n  user<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    \tres<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>성공시에 user를 리턴하므로 아래와 같이 GUID를 포함하여 모든 정보를 돌려보내준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"age\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"5c8f82e29181482127fcc532\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"choi\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"email\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"kingman330@gmail.com\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"password\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"seongheum123\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"__v\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>아래와 같이 고의적으로 error를 발생시키는 data를 보내면</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n\t<span class=\"token string-property property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"choi\"</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token string-property property\">\"email\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"kingman330@gmail.com\"</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token string-property property\">\"password\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1234\"</span>\t<span class=\"token comment\">// 비밀번호가 너무 짧음</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"errors\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"password\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"message\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Path `password` (`1234`) is shorter than the minimum allowed length (7).\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ValidatorError\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"properties\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token property\">\"message\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Path `password` (`1234`) is shorter than the minimum allowed length (7).\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"minlength\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"minlength\"</span><span class=\"token operator\">:</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"path\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"password\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1234\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"kind\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"minlength\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"path\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"password\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1234\"</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"_message\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"User validation failed\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"message\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"User validation failed: password: Path `password` (`1234`) is shorter than the minimum allowed length (7).\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ValidationError\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이와 같이 error를 리턴해준다.</p>\n<p><a href=\"https://httpstatuses.com/\">https://httpstatuses.com/</a></p>\n<blockquote>\n<p>이 주소는 HTTP STATUS CODE들을 정리되어있는 곳이다.</p>\n<p>각 코드에 대한 자세한 설명 또한 볼 수 있다.</p>\n</blockquote>\n<p><strong>1xx - Informational</strong></p>\n<p><strong>2xx - Success</strong></p>\n<p><strong>3xx - Redirection</strong></p>\n<p><strong>4xx - Client Error</strong></p>\n<p><strong>5xx - Server Error</strong></p>\n<p>따라서 위의 request의 경우 client error이므로</p>\n<p>res.status(400) 이 적절하다.</p>\n<p>(400은 bad request를 의미함)</p>\n<h3>Resource Reading Endpoint</h3>\n<hr>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">app<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/users'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  User<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">users</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/users/:id'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> _id <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">.</span>id\t<span class=\"token comment\">// 찾으려는 user의 id를 parameter로 보냈음</span>\n  \n  User<span class=\"token punctuation\">.</span><span class=\"token function\">findById</span><span class=\"token punctuation\">(</span>_id<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">404</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n      res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>단순히 정보를 요청하는 것으로 GET method를 사용하여 users나</p>\n<p>특정 id를 가지고 있는 user를 요청한다. mongoose에 명시되어 있는 method들을 활용하면 좀 더 다양한 방식으로 user를 요청할 수 있다.</p>\n<p>프로젝트가 복잡해질수록 다양한 status를 적절하게 표기해주는 것을 중요하게 생각해야 한다.</p>\n<p>작년에 했던 프로젝트를 떠올리면서 기초부터 다시 다지는 마음으로 정리해봐야겠다.</p>"}},"pageContext":{"slug":"Node-RESTful-API-1"}},
    "staticQueryHashes": ["3159585216","440568431"]}